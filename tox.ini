[tox]
envlist = py37, py38, py39, py310, py311, pep8, docs, packaging

[gh-actions]
python =
    3.7: py37
    3.8: py38
    3.9: py39
    3.10: py310
    3.11: py311, pep8, docs, packaging

[testenv]
allowlist_externals = make
setenv =
    PYTHONPATH = {toxinidir}:{toxinidir}/fcache
commands = make test
deps = -r{toxinidir}/requirements.txt

[testenv:pep8]
allowlist_externals = make
deps =
    flake8
    pep8-naming
    flake8-blind-except
    flake8-builtins
    flake8-pep3101
    flake8-string-format
commands = make lint

[testenv:docs]
changedir = docs
deps =
    sphinx
    releases
allowlist_externals = make
commands =
    make clean
    make html
    make linkcheck

[testenv:packaging]
deps =
    check-manifest
    readme_renderer
commands =
    check-manifest
    python setup.py check -m -r -s
